<h2 id="translationTitle"><img class="theLanguage" src="theme/img/dutch.png" style="width: 50px;"> <span>Translate the word</span></h2>

<p>Below you can translate the word to another language. Choose the proper flag and write the translation.</p>

<p style="display: hidden; color: red;" class="error"> </p>

<div class="row translationLanguages">
	
	
</div>

<a  id="translateWord" class="button expand">Done</a>

<script type="text/javascript">

		$("#translateWord").on("click tap", function(){
			$("#translateModal").foundation('reveal', 'close');
			app.load.word();
		});
		
		$("#translationTitle span").html();
		
		app.log("Getting latest word");
		app.execute.getLatestWord(function(word){
			
			app.execute.getLanguage(word.language, function(language){
				$("#translationTitle span").html("Translate " + word.word);
			
				$(".theLanguage").attr('src', 'theme/img/'+language.image);
			
				app.execute.getAllLanguages(function(languages){
				
					$(".translationLanguages").html();
				
					for(i = 0; i<languages.length;i++) {
						if(languages[i].id != language.id) {
							var item = '<div class="medium-5 columns language" data-attribute="'+languages[i].id+'"><img src="theme/img/'+languages[i].image+'" style="width: 100px;"> <input id="language-'+languages[i].id+'" type="text"> <a id="update-'+languages[i].id+'" class="button updateLanguage">Add '+languages[i].name+' Translation</a></div>';
							
							$(".translationLanguages").append(item);
							
							$("#update-"+languages[i].id).on("click tap", function(){
								var language = $(this).parent().attr('data-attribute');
								var translation = $("#language-"+language).val();
								var translation_id = $("#language-"+language).attr('data-attribute');
								
								app.execute.updateTranslation(word.id, translation, translation_id, language, function(theTranslation){
									$("#language-"+language).html("Update Translation");
									$("#language-"+language).parent().append('<a  id="remove-'+language+'"data-attribute="'+theTranslation+'" class="button remove">Remove Translation</a>');
									
									addRemoveEvent(language);
								});
								
							});
						}
					}
				});
				
				app.execute.getTranslations(word.id, function(array){
					if(array != null) {
						for(i=0;i<array.length;i++) {
							$("#language-"+array[i].language).val(array[i].word);
							$("#update-"+array[i].language).html("Update Translation");
							
							$("#language-"+array[i].language).attr("data-attribute", array[i].id);
							app.log("added word id: " + $("#language-"+array[i].language).attr('data-attribute'));
							
							$("#language-"+array[i].language).parent().append('<a  id="remove-'+array[i].language+'" class="button remove" data-attribute="'+array[i].id+'">Remove Translation</a>');	
							
							addRemoveEvent(array[i].language);
						}
					}
				});
			});
		});
		
		function addRemoveEvent(language) {
			$("#remove-"+language).on("click tap", function(){
				var word_id = $(this).attr('data-attribute');
				var language = $(this).parent().attr('data-attribute');
				
				app.execute.removeTranslation(word_id, function(result){
					$("#language-"+language).val('');
					$("#remove-"+language).remove();
					$("#update-"+language).html("Add Translation");
				});
			});
		}
</script>